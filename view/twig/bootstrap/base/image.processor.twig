{% extends 'base/index' %}

{% block head_title %}{{ translate("title.image.processor") }} - {{ parent() }}{% endblock %}

{% block content_body %}
    <div class="page-header">
        <h1>{{ translate("title.image.processor") }}</h1>
    </div>
{% endblock %}

{% block content_body %}
    {{ parent() }}
    {% import "base/form.prototype" as formPrototype %}

    <div class="image col-md-9">
        {{ image(path, null, {id: "image-input"}) }}
    </div>

    <div class="col-md-3">
        <form id="{{ form.getId() }}" class="form-horizontal" enctype="multipart/form-data" method="post" action="{{ app.url.request }}" name="{{ form.getId() }}" role="form">
            {{ formPrototype.formRows(form) }}
            <input type="submit" class="btn btn-default btn-lg" value="{{ translate("button.save.image") }}" />
            {% if referer %}
                <a href="{{ referer }}" class="btn">{{ translate("button.cancel") }}</a>
            {% endif %}
        </form>

        <h3>{{ translate("image.processor.label.instruction") }}</h3>
        <ul>
            <li>{{ translate("image.processor.label.instruction1") }}</li>
            <li>{{ translate("image.processor.label.instruction2") }}</li>
        </ul>
    </div>
{% endblock %}

{% block styles %}
    {{ parent() }}
    <link href="{$app.url.base}/css/imgareaselect-animated.css" rel="stylesheet" media="screen">
{% endblock %}

{% block scripts %}
    {{ parent() }}
    <script src="{{ app.url.base }}/js/jquery.imgareaselect.pack.js"></script>
    <script type="text/javascript">
        $(function() {
            $('#image-input').imgAreaSelect({
                handles: true,
                onSelectEnd: function (img, selection) {
                    $('input[name="x1"]').val(selection.x1);
                    $('input[name="y1"]').val(selection.y1);
                    $('input[name="x2"]').val(selection.x2);
                    $('input[name="y2"]').val(selection.y2);
                }
            });
        });
    </script>
{% endblock %}
